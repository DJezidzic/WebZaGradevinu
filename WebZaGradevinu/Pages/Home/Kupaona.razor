@using WebZaGradevinu.Data
@using WebZaGradevinu.Services

@inherits OwningComponentBase<ImgUploadService>
<hr />

@foreach (var imgshow in imgdispobj)
{
    if (imgshow.Types == ImageLists.RoomType.Kupaona)
    {
        <figure class="figure">
            <img src="@convertImageForGallery(imgshow.Image)" @onclick="() => ShowModalImg(imgshow) " class="img-thumbnail figure-img" id="myImg" style=" max-width:370px;max-height:430px;" alt="@imgshow.ImageName">
            <figcaption class="figure-caption">@imgshow.ImageName</figcaption>
        </figure>
    }
}
@if (ImgShowToModal)
{
    <ModalComp ImageId="@idImg" Title="@imgTitle" OnClose="@OnModalClose"></ModalComp>
}



@code {

    bool ImgShowToModal = false;
    int idImg;
    string imgTitle;
    void ShowModalImg(ImageLists img)
    {
        idImg = img.ImgId;
        imgTitle = img.ImageName;
        ImgShowToModal = true;

    }

    private async Task OnModalClose(bool accepted)
    {
        ImgShowToModal = false;
        StateHasChanged();
    }

    List<ImageLists> imgdispobj;

    protected override void OnInitialized()
    {
        imgdispobj = Service.displayImage();
    }

    string convertImageForGallery(byte[] image)
    {
        if (image != null)
        {
            var base64 = Convert.ToBase64String(image);
            var fs = string.Format("data:image/jpg;base64,{0}", base64);
            return fs;
        }
        return "";
    }


}

